q <- .2
lam <- 1
mu_r <- 5
mu_g <- 7
p <- 1-q
lam_r <- lam*q
lam_g <- lam*p
matrix_size <- K +1
A<- calc_A_k(K,m,n,lam,lam_r, lam_g, mu_r, mu_g, p)
B<- Calc_B_ki(K,m,n,lam,lam_r, lam_g, mu_r, mu_g, p)
R <- calc_R(A,K,n)
prob_vec <- calc_X(K,m,n,A,B,R)
usethis::use_test()
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
## test params
K <- 5
m <- 2
n <- 2
q <- .2
lam <- 1
mu_r <- 5
mu_g <- 7
p <- 1-q
lam_r <- lam*q
lam_g <- lam*p
matrix_size <- K +1
A<- calc_A_k(K,m,n,lam,lam_r, lam_g, mu_r, mu_g, p)
B<- Calc_B_ki(K,m,n,lam,lam_r, lam_g, mu_r, mu_g, p)
R <- calc_R(A,K,n)
prob_vec <- calc_X(K,m,n,A,B,R)
prob_vec
devtools::load_all(".")
L_q_r <- calc_L_q_r(K,m,prob_vec)
prob_vec[1,1]
m+2
m+!
m+1
p[4]
devtools::load_all(".")
length(prob_vec)
devtools::load_all(".")
devtools::load_all(".")
L_q_r <- calc_L_q_r(K,m,prob_vec)
L_q_r
source("~/GitHub/gensecqueue/R/gensecqueue.R")
L_q_r
devtools::load_all(".")
devtools::load_all(".")
## test params
K <- 5
m <- 2
n <- 2
q <- .2
lam <- 1
mu_r <- 5
mu_g <- 7
p <- 1-q
lam_r <- lam*q
lam_g <- lam*p
matrix_size <- K +1
A<- calc_A_k(K,m,n,lam,lam_r, lam_g, mu_r, mu_g, p)
B<- Calc_B_ki(K,m,n,lam,lam_r, lam_g, mu_r, mu_g, p)
R <- calc_R(A,K,n)
prob_vec <- calc_X(K,m,n,A,B,R)
prob_vec
prob_vec <- calc_X(K,m,n,A,B,R, 0.000000000001)
prob_vec
L_q_r <- calc_L_q_r(K,m,prob_vec)
devtools::load_all(".")
L_q_r <- calc_L_q_r(K,m,prob_vec)
matrix_size <- K+1
size <- length(prob_vec) / matrix_size
L_q_r <- 0
if (m+1+1 > (size)){
L_q_r <- 0
}else{
for(i in (m+1):(size-1)){
for(j in (n):(K)){
#add one to for loops since R indexes at one
val <- (i - m)*p[i+1,j+1]
L_q_r <-  L_q_r + val
}
}
}
size
m+1
size-1
devtools::load_all(".")
L_q_r <- calc_L_q_r(K,m,prob_vec)
L_q_r
matrix_size <- K+1
size <- length(prob_vec) / matrix_size
L_q_r <- 0
if (m+1+1 > (size)){
L_q_r <- 0
}else{
for(i in (m+1+1):(size)){
for(j in (n+1):(K+1)){
#add one to for loops since R indexes at one
val <- (i - m)*p[i,j]
L_q_r <-  L_q_r + val
}
}
}
p
p[1]
p[1,1]
devtools::load_all(".")
source("~/GitHub/gensecqueue/R/gensecqueue.R")
## test params
K <- 5
m <- 2
n <- 2
q <- .2
lam <- 1
mu_r <- 5
mu_g <- 7
p <- 1-q
lam_r <- lam*q
lam_g <- lam*p
matrix_size <- K +1
A<- calc_A_k(K,m,n,lam,lam_r, lam_g, mu_r, mu_g, p)
B<- Calc_B_ki(K,m,n,lam,lam_r, lam_g, mu_r, mu_g, p)
R <- calc_R(A,K,n)
prob_vec <- calc_X(K,m,n,A,B,R, 0.000000000001)
##Example value
ex <- 0
##Test Value
# first sum is i = 3 to inf, add one to all due to indexing
#second sum is 2 to 5,  add one to all due to indexing
L_q_r <- calc_L_q_r(K,m,n,prob_vec)
devtools::load_all(".")
devtools::load_all(".")
## test params
K <- 5
m <- 2
n <- 2
q <- .2
lam <- 1
mu_r <- 5
mu_g <- 7
p <- 1-q
lam_r <- lam*q
lam_g <- lam*p
matrix_size <- K +1
A<- calc_A_k(K,m,n,lam,lam_r, lam_g, mu_r, mu_g, p)
B<- Calc_B_ki(K,m,n,lam,lam_r, lam_g, mu_r, mu_g, p)
R <- calc_R(A,K,n)
prob_vec <- calc_X(K,m,n,A,B,R, 0.000000000001)
##Example value
ex <- 0
##Test Value
# first sum is i = 3 to inf, add one to all due to indexing
#second sum is 2 to 5,  add one to all due to indexing
L_q_r <- calc_L_q_r(K,m,n,prob_vec)
devtools::load_all(".")
## test params
K <- 5
m <- 2
n <- 2
q <- .2
lam <- 1
mu_r <- 5
mu_g <- 7
p <- 1-q
lam_r <- lam*q
lam_g <- lam*p
matrix_size <- K +1
A<- calc_A_k(K,m,n,lam,lam_r, lam_g, mu_r, mu_g, p)
B<- Calc_B_ki(K,m,n,lam,lam_r, lam_g, mu_r, mu_g, p)
R <- calc_R(A,K,n)
prob_vec <- calc_X(K,m,n,A,B,R, 0.000000000001)
##Example value
ex <- 0
##Test Value
# first sum is i = 3 to inf, add one to all due to indexing
#second sum is 2 to 5,  add one to all due to indexing
L_q_r <- calc_L_q_r(K,m,n,prob_vec)
L_q_r
prob_vec
devtools::load_all(".")
prob_vec <- calc_X(K,m,n,A,B,R, 0.000000000001)
prob_vex
prob_vec
ex <- prob_vec[m+1+1,n+1]*(m+1-m) + prob_vec[m+1+1,n+1+1]*(m+1-m) + prob_vec[m+1+1,n+2+1]*(m+1-m) + prob_vec[m+1+1,n+3+1]*(m+1-m) +
prob_vec[m+2+1,n+1]*(m+2-m) + prob_vec[m+2+1,n+1+1]*(m+2-m) + prob_vec[m+2+1,n+2+1]*(m+2-m) + prob_vec[m+2+1,n+3+1]*(m+2-m) +
prob_vec[m+3+1,n+1]*(m+3-m) + prob_vec[m+3+1,n+1+1]*(m+3-m) + prob_vec[m+3+1,n+2+1]*(m+3-m) + prob_vec[m+3+1,n+3+1]*(m+3-m)
ex
L_q_r <- calc_L_q_r(K,m,n,prob_vec)
L_q_r
prob_vec[m+3+1]
prob_vec[m+3+1,n+1]
prob_vec[m+3+1,n+3+1]
devtools::load_all(".")
source("~/GitHub/gensecqueue/R/gensecqueue.R")
source("~/GitHub/gensecqueue/R/gensecqueue.R")
source("~/GitHub/gensecqueue/R/gensecqueue.R")
source("~/GitHub/gensecqueue/R/gensecqueue.R")
source("~/GitHub/gensecqueue/R/gensecqueue.R")
source("~/GitHub/gensecqueue/R/gensecqueue.R")
usethis::use_test()
usethis::use_test()
## test params
K <- 5
m <- 2
n <- 2
q <- .2
lam <- 1
mu_r <- 5
mu_g <- 7
p <- 1-q
lam_r <- lam*q
lam_g <- lam*p
matrix_size <- K +1
A<- calc_A_k(K,m,n,lam,lam_r, lam_g, mu_r, mu_g, p)
B<- Calc_B_ki(K,m,n,lam,lam_r, lam_g, mu_r, mu_g, p)
R <- calc_R(A,K,n)
prob_vec <- calc_X(K,m,n,A,B,R)
prob_vec
prob_vec <- calc_X(K,m,n,A,B,R, 0.000000000001)
prob_vec
devtools::load_all(".")
devtools::load_all(".")
rm(list = c("gensecqueue"))
devtools::load_all(".")
source("~/GitHub/gensecqueue/tests/testthat/test-calc_L_q_g.R")
devtools::load_all(".")
source("~/GitHub/gensecqueue/R/gensecqueue.R")
devtools::load_all(".")
size <- length(prob_vec)
size
devtools::load_all(".")
devtools::load_all(".")
source("~/GitHub/gensecqueue/tests/testthat/test-calc_L_q_g.R")
devtools::load_all(".")
prob_vec[0+1,n+1+1]*(n+1-n) + prob_vec[0,n+2+1]*(n+2-n) + prob_vec[0,n+3+1]*(n+3-n) +
prob_vec[1+1,n+1+1]*(n+1-n) + prob_vec[1,n+2+1]*(n+2-n) + prob_vec[1,n+3+1]*(n+3-n) +
prob_vec[2+1,n+1+1]*(n+1-n) + prob_vec[2,n+2+1]*(n+2-n) + prob_vec[2,n+3+1]*(n+3-n)
prob_vec[0+1,n+1+1]*(n+1-n) + prob_vec[0,n+2+1]*(n+2-n) + prob_vec[0,n+3+1]*(n+3-n) +
prob_vec[1+1,n+1+1]*(n+1-n) + prob_vec[1,n+2+1]*(n+2-n) + prob_vec[1,n+3+1]*(n+3-n) +
prob_vec[2+1,n+1+1]*(n+1-n) + prob_vec[2,n+2+1]*(n+2-n) + prob_vec[2,n+3+1]*(n+3-n)
prob_vec[0+1,n+1+1]
prob_vec[0+1,n+1+1]*2
prob_vec[0+1,n+1+1]*(n+1-n)
prob_vec[0,n+2+1]*(n+2-n
)
prob_vec[0,n+2+1]
prob_vec[0+1,n+1+1]*(n+1-n) + prob_vec[0,n+2+1]*(n+2-n) + prob_vec[0,n+3+1]*(n+3-n)
prob_vec[0,n+3+1]*(n+3-n)
as.numeric(prob_vec[0,n+3+1]*(n+3-n))
as.integer(prob_vec[0,n+3+1]*(n+3-n))
prob_vec
as.integer(prob_vec[0,n+3+1]*(n+3-n))
lapply(prob_vec, function(x)x[lengths(x) == 0] <- 0)
prob_vec[0+1,n+1+1]*(n+1-n) + prob_vec[0,n+2+1]*(n+2-n) + (prob_vec[0,n+3+1]*(n+3-n))
prob_vec[0+1,n+1+1]*(n+1-n)
(prob_vec[0+1,n+1+1]*(n+1-n)) + (prob_vec[0,n+2+1]*(n+2-n)) + (prob_vec[0,n+3+1]*(n+3-n))
prob_vec <- calc_X(K,m,n,A,B,R)
L_q_g <- calc_L_q_g(K,n,prob_vec)
L_q_g
as.double(prob_vec[0+1,n+1+1])
as.double(prob_vec[0+1,n+1+1])*(n+1-n) + as.double(prob_vec[0,n+2+1])*(n+2-n) + as.double(prob_vec[0,n+3+1])*(n+3-n) +
as.double(prob_vec[1+1,n+1+1])*(n+1-n) + as.double(prob_vec[1,n+2+1])*(n+2-n) + as.double(prob_vec[1,n+3+1])*(n+3-n) +
as.double(prob_vec[2+1,n+1+1])*(n+1-n) + as.double(prob_vec[2,n+2+1])*(n+2-n) + as.double(prob_vec[2,n+3+1])*(n+3-n) +
as.double(prob_vec[3+1,n+1+1])*(n+1-n) + as.double(prob_vec[3,n+2+1])*(n+2-n) + as.double(prob_vec[3,n+3+1])*(n+3-n) +
as.double(prob_vec[4+1,n+1+1])*(n+1-n) + as.double(prob_vec[4,n+2+1])*(n+2-n) + as.double(prob_vec[4,n+3+1])*(n+3-n) +
as.double(prob_vec[5+1,n+1+1])*(n+1-n) + as.double(prob_vec[5,n+2+1])*(n+2-n) + as.double(prob_vec[5,n+3+1])*(n+3-n)
prob_vec
as.double(prob_vec[0+1,n+1+1])*(n+1-n) + as.double(prob_vec[0+1,n+2+1])*(n+2-n) + as.double(prob_vec[0+1,n+3+1])*(n+3-n) +
as.double(prob_vec[1+1,n+1+1])*(n+1-n) + as.double(prob_vec[1+1,n+2+1])*(n+2-n) + as.double(prob_vec[1+1,n+3+1])*(n+3-n) +
as.double(prob_vec[2+1,n+1+1])*(n+1-n) + as.double(prob_vec[2+1,n+2+1])*(n+2-n) + as.double(prob_vec[2+1,n+3+1])*(n+3-n) +
as.double(prob_vec[3+1,n+1+1])*(n+1-n) + as.double(prob_vec[3+1,n+2+1])*(n+2-n) + as.double(prob_vec[3+1,n+3+1])*(n+3-n) +
as.double(prob_vec[4+1,n+1+1])*(n+1-n) + as.double(prob_vec[4+1,n+2+1])*(n+2-n) + as.double(prob_vec[4+1,n+3+1])*(n+3-n) +
as.double(prob_vec[5+1,n+1+1])*(n+1-n) + as.double(prob_vec[5+1,n+2+1])*(n+2-n) + as.double(prob_vec[5+1,n+3+1])*(n+3-n)
(prob_vec[0+1,n+1+1]*(n+1-n)) + (prob_vec[0+1,n+2+1]*(n+2-n)) + (prob_vec[0+1,n+3+1]*(n+3-n)) +
prob_vec[1+1,n+1+1]*(n+1-n) + prob_vec[1,n+2+1]*(n+2-n) + prob_vec[1,n+3+1]*(n+3-n) +
prob_vec[2+1,n+1+1]*(n+1-n) + prob_vec[2,n+2+1]*(n+2-n) + prob_vec[2,n+3+1]*(n+3-n)
devtools::load_all(".")
usethis::use_test()
devtools::load_all(".")
usethis::use_test()
devtools::load_all(".")
prob_vec <- calc_X(K,m,n,A,B,R)
prob_vec
prob_vec <- calc_X(K,m,n,A,B,R, 0.000000000001)
prob_vec
devtools::load_all(".")
prob_vec[0+1,n+1] + prob_vec[0+1,n+1+1] + prob_vec[0+1,n+2+1] + prob_vec[0+1,n+3+1]
prob_vec[1+1,n+1] + prob_vec[1+1,n+1+1] + prob_vec[1+1,n+2+1] + prob_vec[1+1,n+3+1] +
prob_vec[2+1,n+1] + prob_vec[2+1,n+1+1] + prob_vec[2+1,n+2+1] + prob_vec[2+1,n+3+1]
calc_p_B_g(K,n,prob_vec)
devtools::load_all(".")
prob_vec[0+1,n+1] + prob_vec[0+1,n+1+1] + prob_vec[0+1,n+2+1] + prob_vec[0+1,n+3+1]
prob_vec[1+1,n+1] + prob_vec[1+1,n+1+1] + prob_vec[1+1,n+2+1] + prob_vec[1+1,n+3+1] +
prob_vec[2+1,n+1] + prob_vec[2+1,n+1+1] + prob_vec[2+1,n+2+1] + prob_vec[2+1,n+3+1]
devtools::load_all(".")
prob_vec[0+1,n+1] + prob_vec[0+1,n+1+1] + prob_vec[0+1,n+2+1] + prob_vec[0+1,n+3+1] +
prob_vec[1+1,n+1] + prob_vec[1+1,n+1+1] + prob_vec[1+1,n+2+1] + prob_vec[1+1,n+3+1] +
prob_vec[2+1,n+1] + prob_vec[2+1,n+1+1] + prob_vec[2+1,n+2+1] + prob_vec[2+1,n+3+1]
calc_p_B_g(K,n,prob_vec)
prob_vec
calc_X(K,m,n,A,B,R, 0.000000000001)
prob_vec <- calc_X(K,m,n,A,B,R, 0.000000000001)
prob_vec[0+1,n+1]+ as.double(prob_vec[0+1,n+1+1])+ as.double(prob_vec[0+1,n+2+1])+ as.double(prob_vec[0+1,n+3+1]) +
prob_vec[1+1,n+1]+ as.double(prob_vec[1+1,n+1+1])+ as.double(prob_vec[1+1,n+2+1])+ as.double(prob_vec[1+1,n+3+1]) +
prob_vec[2+1,n+1]+ as.double(prob_vec[2+1,n+1+1])+ as.double(prob_vec[2+1,n+2+1])+ as.double(prob_vec[2+1,n+3+1]) +
prob_vec[3+1+1,n+1]+ as.double(prob_vec[3+1,n+1+1])+ as.double(prob_vec[3+1,n+2+1])+ as.double(prob_vec[3+1,n+3+1]) +
prob_vec[4+1,n+1]+ as.double(prob_vec[4+1,n+1+1])+ as.double(prob_vec[4+1,n+2+1])+ as.double(prob_vec[4+1,n+3+1]) +
prob_vec[5+1,n+1]+ as.double(prob_vec[5+1,n+1+1])+ as.double(prob_vec[5+1,n+2+1])+ as.double(prob_vec[5+1,n+3+1])
calc_p_B_g(K,n,prob_vec)
length(prob_vec) / matrix_size
prob_vec[0+1,n+1]+ (prob_vec[0+1,n+1+1])+ (prob_vec[0+1,n+2+1])+ (prob_vec[0+1,n+3+1]) +
prob_vec[1+1,n+1]+ (prob_vec[1+1,n+1+1])+ (prob_vec[1+1,n+2+1])+ (prob_vec[1+1,n+3+1]) +
prob_vec[2+1,n+1]+ (prob_vec[2+1,n+1+1])+ (prob_vec[2+1,n+2+1])+ (prob_vec[2+1,n+3+1]) +
prob_vec[3+1+1,n+1]+ (prob_vec[3+1,n+1+1])+ (prob_vec[3+1,n+2+1])+ (prob_vec[3+1,n+3+1]) +
prob_vec[4+1,n+1]+ (prob_vec[4+1,n+1+1])+ (prob_vec[4+1,n+2+1])+ (prob_vec[4+1,n+3+1]) +
prob_vec[5+1,n+1]+ (prob_vec[5+1,n+1+1])+ (prob_vec[5+1,n+2+1])+ (prob_vec[5+1,n+3+1])
prob_vec[0+1,n+1]+ (prob_vec[0+1,n+1+1])+ (prob_vec[0+1,n+2+1])+ (prob_vec[0+1,n+3+1]) +
prob_vec[1+1,n+1]+ (prob_vec[1+1,n+1+1])+ (prob_vec[1+1,n+2+1])+ (prob_vec[1+1,n+3+1]) +
prob_vec[2+1,n+1]+ (prob_vec[2+1,n+1+1])+ (prob_vec[2+1,n+2+1])+ (prob_vec[2+1,n+3+1]) +
prob_vec[3+1,n+1]+ (prob_vec[3+1,n+1+1])+ (prob_vec[3+1,n+2+1])+ (prob_vec[3+1,n+3+1]) +
prob_vec[4+1,n+1]+ (prob_vec[4+1,n+1+1])+ (prob_vec[4+1,n+2+1])+ (prob_vec[4+1,n+3+1]) +
prob_vec[5+1,n+1]+ (prob_vec[5+1,n+1+1])+ (prob_vec[5+1,n+2+1])+ (prob_vec[5+1,n+3+1])
calc_p_B_g(K,n,prob_vec)
prob_vec[0+1,n+1] + prob_vec[0+1,n+1+1] + prob_vec[0+1,n+2+1] + prob_vec[0+1,n+3+1] +
prob_vec[1+1,n+1] + prob_vec[1+1,n+1+1] + prob_vec[1+1,n+2+1] + prob_vec[1+1,n+3+1] +
prob_vec[2+1,n+1] + prob_vec[2+1,n+1+1] + prob_vec[2+1,n+2+1] + prob_vec[2+1,n+3+1]
prob_vec <- calc_X(K,m,n,A,B,R)
calc_p_B_g(K,n,prob_vec)
devtools::load_all(".")
usethis::use_test()
devtools::load_all(".")
devtools::load_all(".")
prob_vec <- calc_X(K,m,n,A,B,R)
prob_vec[0+1,n+1+1] + prob_vec[0+1,n+2+1] + prob_vec[0+1,n+3+1] +
prob_vec[1+1,n+1+1] + prob_vec[1+1,n+2+1] + prob_vec[1+1,n+3+1]
calc_alpha(m,n,prob_vec,K)
prob_vec
devtools::load_all(".")
prob_vec[0+1,n+1+1] + prob_vec[0+1,n+2+1] + prob_vec[0+1,n+3+1] +
prob_vec[1+1,n+1+1] + prob_vec[1+1,n+2+1] + prob_vec[1+1,n+3+1]
calc_alpha(m,n,prob_vec,K)
prob_vec <- calc_X(K,m,n,A,B,R, 0.000000000001)
devtools::load_all(".")
usethis::use_test()
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
## test params
K <- 5
m <- 2
n <- 2
q <- .2
lam <- 1
mu_r <- 5
mu_g <- 7
p <- 1-q
lam_r <- lam*q
lam_g <- lam*p
matrix_size <- K +1
A<- calc_A_k(K,m,n,lam,lam_r, lam_g, mu_r, mu_g, p)
B<- Calc_B_ki(K,m,n,lam,lam_r, lam_g, mu_r, mu_g, p)
R <- calc_R(A,K,n)
prob_vec <- calc_X(K,m,n,A,B,R)
p_B_r <- calc_p_B_r(m,n, K, prob_vec)
p_B_g <- calc_p_B_g(K,n,prob_vec)
# probability R finishes before G
R_fin <- (n*mu_g) / (m*mu_r + n*mu_g)
# probability G finishes before R
G_fin<- (m*mu_r) / (m*mu_r + n*mu_g)
(lam_r * (1 - p_B_r) ) / (m*mu_r)
ex <- (lam_r * (1 - p_B_r) ) / (m*mu_r)
ex + ((lam_r*p_B_r*p_B_g*(R_fin + (q*R_fin*G_fin)+ (q^2*R_fin*G_fin^2)))/(m*mu_r))
((lam_r*p_B_r*p_B_g*(R_fin + (q*R_fin*G_fin)+ (q^2*R_fin*G_fin^2)))/(m*mu_r))
K <- 5
m <- 2
n <- 2
q <- .8
lam <- 1
mu_r <- 5
mu_g <- 7
p <- 1-q
lam_r <- lam*q
lam_g <- lam*p
matrix_size <- K +1
A<- calc_A_k(K,m,n,lam,lam_r, lam_g, mu_r, mu_g, p)
B<- Calc_B_ki(K,m,n,lam,lam_r, lam_g, mu_r, mu_g, p)
R <- calc_R(A,K,n)
prob_vec <- calc_X(K,m,n,A,B,R)
p_B_r <- calc_p_B_r(m,n, K, prob_vec)
p_B_g <- calc_p_B_g(K,n,prob_vec)
# probability R finishes before G
R_fin <- (n*mu_g) / (m*mu_r + n*mu_g)
# probability G finishes before R
G_fin<- (m*mu_r) / (m*mu_r + n*mu_g)
##Example 1 value
ex <- (lam_r * (1 - p_B_r) ) / (m*mu_r)
ex <- ex + ((lam_r*p_B_r*p_B_g*(R_fin + (q*R_fin*G_fin)+ (q^2*R_fin*G_fin^2)))/(m*mu_r))
ex
((lam_r*p_B_r*p_B_g*(R_fin + (q*R_fin*G_fin)+ (q^2*R_fin*G_fin^2)))/(m*mu_r))
devtools::load_all(".")
ex <- (lam_r * (1 - p_B_r) ) / (m*mu_r)
ex <- ex + ((lam_r*p_B_r*p_B_g*(R_fin + (q*R_fin*G_fin)+ (q^2*R_fin*G_fin^2)))/(m*mu_r))
ex*1000000
ex*10000000000000
ex*100000000000000000000000
ex*100000000000000000
ex*100000000000000
ex*10000000000000
##Example 1 value
ex <- (lam_r * (1 - p_B_r) ) / (m*mu_r)
ex <- ex + ((lam_r*p_B_r*p_B_g*(R_fin + (q*R_fin*G_fin)+ (q^2*R_fin*G_fin^2)))/(m*mu_r))
##Test 1 Value
rho_r <- calc_rho_r( K, p, n, m, p_B_r, p_B_g, mu_r, mu_g, lam_r)
## Test 1
expect_equal(ex*10000000000000, rho_r*10000000000000)
ex
ex*10000000000000
rho_r*10000000000000
devtools::load_all(".")
usethis::use_test()
((lam_r*p_B_r*p_B_g*(R_fin + (q*R_fin*G_fin)+ (q^2*R_fin*G_fin^2)))/(m*mu_r))
((lam_r*p_B_r*p_B_g*(R_fin + (R_fin*G_fin)+ (R_fin*G_fin^2)))/(m*mu_r))
prob_vec <- calc_X(K,m,n,A,B,R)
prob_vec
prob_vec <- calc_X(K,m,n,A,B,R, .000000001)
prob_vec
prob_vec <- calc_X(K,m,n,A,B,R, .0000000000001)
prob_vec
prob_vec <- calc_X(K,m,n,A,B,R, .0000000001)
prob_vec
prob_vec <- calc_X(K,m,n,A,B,R, .00000000001)
prob_vec
calc_X(K,m,n,A,B,R, .0000000001)
#queue length 1
p_l_1 <- prob_vec[4,3] +prob_vec[4,4]+prob_vec[4,5]+prob_vec[4,6]
ex <- ex + ((lam_r*p_B_r*p_B_g*(p_l_1*R_fin ))/(m*mu_r))
#queue length 2
p_l_2 <- prob_vec[5,3] +prob_vec[5,4]+prob_vec[5,5]+prob_vec[5,6]
ex <- ex + ((lam_r*p_B_r*p_B_g*(p_l_2*R_fin*G_fin))/(m*mu_r))
ex
((lam_r*p_B_r*p_B_g*(p_l_2*R_fin*G_fin))/(m*mu_r))
((lam_r*p_B_r*p_B_g*(p_l_1*R_fin ))/(m*mu_r))
calc_rho_r( K, p, n, m, p_B_r, p_B_g, mu_r, mu_g, lam_r)
ex*10000000000000
rho_r*10000000000000
devtools::load_all(".")
length(prob_vec)
length(prob_vec)/K
length(prob_vec)/K+1
length(prob_vec)/(K+1)
devtools::load_all(".")
devtools::load_all(".")
prob_vex
prob_vex
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
rm(list = c("gensecqueue"))`
)
""
``
rm(list = c("gensecqueue"))
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
K <- 5
m <- 2
n <- 2
q <- .8
lam <- 1
mu_r <- 5
mu_g <- 7
p <- 1-q
lam_r <- lam*q
lam_g <- lam*p
gensecqueue(lam,n,m, p, mu_g, mu_r)
devtools::load_all(".")
devtools::load_all(".")
gensecqueue(lam,n,m, p, mu_g, mu_r)
devtools::load_all(".")
gensecqueue(lam,n,m, p, mu_g, mu_r)
devtools::load_all(".")
devtools::load_all(".")
gensecqueue(lam,n,m, p, mu_g, mu_r)
gensecqueue(lam,n,m, p, mu_g, mu_r)
i
m
prob_vec
j
size
devtools::load_all(".")
gensecqueue(lam,n,m, p, mu_g, mu_r)
gensecqueue(lam,n,m, .8, mu_g, mu_r)
gensecqueue(5,n,m, .8, mu_g, mu_r)
gensecqueue(8,n,m, .8, mu_g, mu_r)
gensecqueue(7,n,m, .8, mu_g, mu_r)
gensecqueue(6,n,m, .8, mu_g, mu_r)
gensecqueue(15,n,m, .8, mu_g, mu_r)
gensecqueue(80,n,m, .8, mu_g, mu_r)
gensecqueue(7,n,m, .2, mu_g, mu_r)
